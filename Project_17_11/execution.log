[root@sandbox-hdp hadoop_mini_project]# bash map_reduce.sh                                                                                                                                                         
22/02/12 03:34:43 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.
22/02/12 03:34:44 INFO client.RMProxy: Connecting to ResourceManager at sandbox-hdp.hortonworks.com/172.18.0.2:8050
22/02/12 03:34:45 INFO client.AHSProxy: Connecting to Application History server at sandbox-hdp.hortonworks.com/172.18.0.2:10200
22/02/12 03:34:45 INFO client.RMProxy: Connecting to ResourceManager at sandbox-hdp.hortonworks.com/172.18.0.2:8050
22/02/12 03:34:45 INFO client.AHSProxy: Connecting to Application History server at sandbox-hdp.hortonworks.com/172.18.0.2:10200
22/02/12 03:34:45 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /user/root/.staging/job_1644448032385_0020                                                                                
22/02/12 03:34:46 INFO mapred.FileInputFormat: Total input files to process : 1                                                                                                                                    
22/02/12 03:34:46 INFO mapreduce.JobSubmitter: number of splits:2                                                                                                                                                  
22/02/12 03:34:47 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1644448032385_0020                                                                                                                   
22/02/12 03:34:47 INFO mapreduce.JobSubmitter: Executing with tokens: []                                                                                                                                           
22/02/12 03:34:47 INFO conf.Configuration: found resource resource-types.xml at file:/etc/hadoop/3.0.1.0-187/0/resource-types.xml                                                                                  
22/02/12 03:34:47 INFO impl.YarnClientImpl: Submitted application application_1644448032385_0020                                                                                                                   
22/02/12 03:34:47 INFO mapreduce.Job: The url to track the job: http://sandbox-hdp.hortonworks.com:8088/proxy/application_1644448032385_0020/                                                                      
22/02/12 03:34:47 INFO mapreduce.Job: Running job: job_1644448032385_0020                                                                                                                                          
22/02/12 03:34:56 INFO mapreduce.Job: Job job_1644448032385_0020 running in uber mode : false                                                                                                                      
22/02/12 03:34:56 INFO mapreduce.Job:  map 0% reduce 0%                                                                                                                                                            
22/02/12 03:35:03 INFO mapreduce.Job:  map 50% reduce 0%                                                                                                                                                           
22/02/12 03:35:06 INFO mapreduce.Job:  map 100% reduce 0%                                                                                                                                                          
22/02/12 03:35:11 INFO mapreduce.Job:  map 100% reduce 100%                                                                                                                                                        
22/02/12 03:35:13 INFO mapreduce.Job: Job job_1644448032385_0020 completed successfully                                                                                                                            
22/02/12 03:35:14 INFO mapreduce.Job: Counters: 53                                                                                                                                                                 
        File System Counters                                                                                                                                                                                       
                FILE: Number of bytes read=606                                                                                                                                                                     
                FILE: Number of bytes written=716426                                                                                                                                                               
                FILE: Number of read operations=0                                                                                                                                                                  
                FILE: Number of large read operations=0                                                                                                                                                            
                FILE: Number of write operations=0                                                                                                                                                                 
                HDFS: Number of bytes read=1722                                                                                                                                                                    
                HDFS: Number of bytes written=126                                                                                                                                                                  
                HDFS: Number of read operations=11                                                                                                                                                                 
                HDFS: Number of large read operations=0                                                                                                                                                            
                HDFS: Number of write operations=2                                                                                                                                                                 
        Job Counters                                                                                                                                                                                               
                Launched map tasks=2                                                                                                                                                                               
                Launched reduce tasks=1                                                                                                                                                                            
                Data-local map tasks=2                                                                                                                                                                             
                Total time spent by all maps in occupied slots (ms)=51732                                                                                                                                          
                Total time spent by all reduces in occupied slots (ms)=20668                                                                                                                                       
                Total time spent by all map tasks (ms)=12933                                                                                                                                                       
                Total time spent by all reduce tasks (ms)=5167                                                                                                                                                     
                Total vcore-milliseconds taken by all map tasks=12933                                                                                                                                              
                Total vcore-milliseconds taken by all reduce tasks=5167                                                                                                                                            
                Total megabyte-milliseconds taken by all map tasks=13243392                                                                                                                                        
                Total megabyte-milliseconds taken by all reduce tasks=5291008                                                                                                                                      
        Map-Reduce Framework                                                                                                                                                                                       
                Map input records=16                                                                                                                                                                               
                Map output records=16                                                                                                                                                                              
                Map output bytes=568                                                                                                                                                                               
                Map output materialized bytes=612                                                                                                                                                                  
                Input split bytes=232                                                                                                                                                                              
                Combine input records=0                                                                                                                                                                            
                Combine output records=0                                                                                                                                                                           
                Reduce input groups=5                                                                                                                                                                              
                Reduce shuffle bytes=612                                                                                                                                                                           
                Reduce input records=16                                                                                                                                                                            
                Reduce output records=4                                                                                                                                                                            
                Spilled Records=32                                                                                                                                                                                 
                Shuffled Maps =2                                                                                                                                                                                   
                Failed Shuffles=0                                                                                                                                                                                  
                Merged Map outputs=2                                                                                                                                                                               
                GC time elapsed (ms)=418                                                                                                                                                                           
                CPU time spent (ms)=3710                                                                                                                                                                           
                Physical memory (bytes) snapshot=1744261120                                                                                                                                                        
                Virtual memory (bytes) snapshot=8327868416                                                                                                                                                         
                Total committed heap usage (bytes)=1600126976                                                                                                                                                      
                Peak Map Physical memory (bytes)=778096640                                                                                                                                                         
                Peak Map Virtual memory (bytes)=2843443200                                                                                                                                                         
                Peak Reduce Physical memory (bytes)=205598720                                                                                                                                                      
                Peak Reduce Virtual memory (bytes)=2647810048                                                                                                                                                      
        Shuffle Errors                                                                                                                                                                                             
                BAD_ID=0                                                                                                                                                                                           
                CONNECTION=0                                                                                                                                                                                       
                IO_ERROR=0                                                                                                                                                                                         
                WRONG_LENGTH=0                                                                                                                                                                                     
                WRONG_MAP=0                                                                                                                                                                                        
                WRONG_REDUCE=0                                                                                                                                                                                     
        File Input Format Counters                                                                                                                                                                                 
                Bytes Read=1490                                                                                                                                                                                    
        File Output Format Counters                                                                                                                                                                                
                Bytes Written=126                                                                                                                                                                                  
22/02/12 03:35:14 INFO streaming.StreamJob: Output directory: output/all_accidents                                                                                                                                 
22/02/12 03:35:16 WARN streaming.StreamJob: -file option is deprecated, please use generic option -files instead.                                                                                                  
22/02/12 03:35:18 INFO client.RMProxy: Connecting to ResourceManager at sandbox-hdp.hortonworks.com/172.18.0.2:8050                                                                                                
22/02/12 03:35:18 INFO client.AHSProxy: Connecting to Application History server at sandbox-hdp.hortonworks.com/172.18.0.2:10200                                                                                   
22/02/12 03:35:18 INFO client.RMProxy: Connecting to ResourceManager at sandbox-hdp.hortonworks.com/172.18.0.2:8050                                                                                                
22/02/12 03:35:18 INFO client.AHSProxy: Connecting to Application History server at sandbox-hdp.hortonworks.com/172.18.0.2:10200                                                                                   
22/02/12 03:35:19 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /user/root/.staging/job_1644448032385_0021                                                                                
22/02/12 03:35:19 INFO mapred.FileInputFormat: Total input files to process : 1                                                                                                                                    
22/02/12 03:35:20 INFO mapreduce.JobSubmitter: number of splits:2                                                                                                                                                  
22/02/12 03:35:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1644448032385_0021                                                                                                                   
22/02/12 03:35:20 INFO mapreduce.JobSubmitter: Executing with tokens: []                                                                                                                                           
22/02/12 03:35:21 INFO conf.Configuration: found resource resource-types.xml at file:/etc/hadoop/3.0.1.0-187/0/resource-types.xml                                                                                  
22/02/12 03:35:21 INFO impl.YarnClientImpl: Submitted application application_1644448032385_0021                                                                                                                   
22/02/12 03:35:21 INFO mapreduce.Job: The url to track the job: http://sandbox-hdp.hortonworks.com:8088/proxy/application_1644448032385_0021/                                                                      
22/02/12 03:35:21 INFO mapreduce.Job: Running job: job_1644448032385_0021                                                                                                                                          
22/02/12 03:35:30 INFO mapreduce.Job: Job job_1644448032385_0021 running in uber mode : false                                                                                                                      
22/02/12 03:35:30 INFO mapreduce.Job:  map 0% reduce 0%                                                                                                                                                            
22/02/12 03:35:38 INFO mapreduce.Job:  map 50% reduce 0%                                                                                                                                                           
22/02/12 03:35:39 INFO mapreduce.Job:  map 100% reduce 0%                                                                                                                                                          
22/02/12 03:35:46 INFO mapreduce.Job:  map 100% reduce 100%                                                                                                                                                        
22/02/12 03:35:47 INFO mapreduce.Job: Job job_1644448032385_0021 completed successfully                                                                                                                            
22/02/12 03:35:47 INFO mapreduce.Job: Counters: 53                                                                                                                                                                 
        File System Counters                                                                                                                                                                                       
                FILE: Number of bytes read=76                                                                                                                                                                      
                FILE: Number of bytes written=715390                                                                                                                                                               
                FILE: Number of read operations=0                                                                                                                                                                  
                FILE: Number of large read operations=0                                                                                                                                                            
                FILE: Number of write operations=0                                                                                                                                                                 
                HDFS: Number of bytes read=455                                                                                                                                                                     
                HDFS: Number of bytes written=46                                                                                                                                                                   
                HDFS: Number of read operations=11                                                                                                                                                                 
                HDFS: Number of large read operations=0                                                                                                                                                            
                HDFS: Number of write operations=2                                                                                                                                                                 
        Job Counters                                                                                                                                                                                               
                Launched map tasks=2                                                                                                                                                                               
                Launched reduce tasks=1                                                                                                                                                                            
                Data-local map tasks=2                                                                                                                                                                             
                Total time spent by all maps in occupied slots (ms)=47872                                                                                                                                          
                Total time spent by all reduces in occupied slots (ms)=22740                                                                                                                                       
                Total time spent by all map tasks (ms)=11968                                                                                                                                                       
                Total time spent by all reduce tasks (ms)=5685                                                                                                                                                     
                Total vcore-milliseconds taken by all map tasks=11968                                                                                                                                              
                Total vcore-milliseconds taken by all reduce tasks=5685                                                                                                                                            
                Total megabyte-milliseconds taken by all map tasks=12255232                                                                                                                                        
                Total megabyte-milliseconds taken by all reduce tasks=5821440                                                                                                                                      
        Map-Reduce Framework                                                                                                                                                                                       
                Map input records=4                                                                                                                                                                                
                Map output records=4                                                                                                                                                                               
                Map output bytes=62                                                                                                                                                                                
                Map output materialized bytes=82                                                                                                                                                                   
                Input split bytes=266                                                                                                                                                                              
                Combine input records=0                                                                                                                                                                            
                Combine output records=0                                                                                                                                                                           
                Reduce input groups=3                                                                                                                                                                              
                Reduce shuffle bytes=82                                                                                                                                                                            
                Reduce input records=4                                                                                                                                                                             
                Reduce output records=3                                                                                                                                                                            
                Spilled Records=8                                                                                                                                                                                  
                Shuffled Maps =2                                                                                                                                                                                   
                Failed Shuffles=0                                                                                                                                                                                  
                Merged Map outputs=2                                                                                                                                                                               
                GC time elapsed (ms)=349                                                                                                                                                                           
                CPU time spent (ms)=3430                                                                                                                                                                           
                Physical memory (bytes) snapshot=1741164544                                                                                                                                                        
                Virtual memory (bytes) snapshot=8330620928                                                                                                                                                         
                Total committed heap usage (bytes)=1580204032                                                                                                                                                      
                Peak Map Physical memory (bytes)=776916992                                                                                                                                                         
                Peak Map Virtual memory (bytes)=2841382912                                                                                                                                                         
                Peak Reduce Physical memory (bytes)=207597568                                                                                                                                                      
                Peak Reduce Virtual memory (bytes)=2648551424                                                                                                                                                      
        Shuffle Errors                                                                                                                                                                                             
                BAD_ID=0                                                                                                                                                                                           
                CONNECTION=0                                                                                                                                                                                       
                IO_ERROR=0                                                                                                                                                                                         
                WRONG_LENGTH=0                                                                                                                                                                                     
                WRONG_MAP=0                                                                                                                                                                                        
                WRONG_REDUCE=0                                                                                                                                                                                     
        File Input Format Counters                                                                                                                                                                                 
                Bytes Read=189                                                                                                                                                                                     
        File Output Format Counters                                                                                                                                                                                
                Bytes Written=46                                                                                                                                                                                   
22/02/12 03:35:47 INFO streaming.StreamJob: Output directory: output/make_year_count